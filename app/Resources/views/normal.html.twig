{% extends '::base.html.twig' %}

{% block section %}

{# Buscador #}
<script>
	$.datepicker.setDefaults($.datepicker.regional[ "{{ app.request.locale }}" ]);

	$(function() {
		/* Fecha por hora */
		var dateDay 	= {{ selection.dateDay|json_encode() }};
		var dateMonth	= {{ selection.dateMonth|json_encode() }};
		var dateYear 	= {{ selection.dateYear|json_encode() }};

		if(!dateDay && !dateMonth && !dateYear){
			var today 	= new Date();
			dateYear 	= today.getFullYear();
			dateMonth 	= today.getMonth();
			dateDay 	= today.getDay() + 2;
			if(dateDay < 10)	{dateDay 	= '0' + dateDay;	}
			if(dateMonth < 10)	{dateMonth	= '0' + dateMonth;	}
		}

		$("#dateByHour").datepicker({
			dateFormat: 		"dd/mm/yy",
			defaultDate: 		+2,
			minDate: 			+2,
		});
		$("#dateByHour").datepicker( "setDate", new Date(dateYear, dateMonth, dateDay));

		/* Fechas por días */
		var StartDateDay 	= {{ selection.StartDateDay|json_encode() }};
		var StartDateMonth	= {{ selection.StartDateYear|json_encode() }};
		var StartDateYear 	= {{ selection.StartDateYear|json_encode() }};
		var EndDateDay 		= {{ selection.EndDateDay|json_encode() }};
		var EndDateMonth	= {{ selection.EndDateYear|json_encode() }};
		var EndDateYear 	= {{ selection.EndDateYear|json_encode() }};

		if(!StartDateDay && !StartDateMonth && !StartDateYear && !EndDateDay && !EndDateMonth && !EndDateYear){
			var today 	= new Date();
			StartDateYear 	= today.getFullYear();
			StartDateMonth 	= today.getMonth();
			StartDateDay 	= today.getDay() + 2;
			if(StartDateDay < 10)	{StartDateDay 	= '0' + StartDateDay;	}
			if(StartDateMonth < 10)	{StartDateMonth	= '0' + StartDateMonth;	}

			StartDateYear 	= today.getFullYear();
			EndDateMonth 	= today.getMonth();
			EndDateDay 		= today.getDay() + 3;
			if(EndDateMonth < 10)	{EndDateMonth 	= '0' + EndDateMonth;	}
			if(EndDateDay < 10)	{EndDateDay	= '0' + EndDateDay;	}
		}

		$("#dateByDaySD").datepicker({
			dateFormat: 		"dd/mm/yy",
			defaultDate: 		+2,
			minDate: 			+2,
			onClose: function(selectedDate) {
				$("#dateByDayED").datepicker("option", "minDate", selectedDate );
			}
		});
		$("#dateByDaySD").datepicker( "setDate", new Date(StartDateYear, StartDateMonth, StartDateDay));

		$("#dateByDayED").datepicker({
			dateFormat: 		"dd/mm/yy",
			defaultDate: 		+3,
			minDate: 			+3,
			onClose: function(selectedDate) {
				$( "#dateByDaySD" ).datepicker( "option", "maxDate", selectedDate );
			}
		});
		$("#dateByDayED").datepicker( "setDate", new Date(EndDateYear, EndDateMonth, EndDateDay));

		$("#byHour").click(function() {
			$("#byHourDiv").show("slow");
			$("#byDayDiv").hide("slow");
		});

		$("#byDay").click(function() {
			$("#byHourDiv").hide("slow");
			$("#byDayDiv").show("slow");
		});
	});
</script>

<div class="col-md-4 column mainContent">
	<form action="{{ path('search') }}" method="POST">
		<label>{% trans %}Nombre{% endtrans %}</label>
		<input class="thisInput" type="text" name="name" value="{{ selection['name'] }}">

		<label>{% trans %}Alquilar por{% endtrans %}</label><br/>
		{% if selection['type'] == 'day' %}
			&nbsp;&nbsp;<input id="byHour" type="radio" name="type" value="hour">{% trans %}Hora{% endtrans %}&nbsp;&nbsp;<input id="byDay" type="radio" name="type" value="day" checked>{% trans %}Día{% endtrans %}

			<div id="byHourDiv" style="display:none">
			<table class="dateHourTable">
					<th><label>{% trans %}Fecha{% endtrans %}</label></th>
					<th><label style="float: right;">{% trans %}Hora{% endtrans %}</label></th>
				</tr>
				<tr>
					<td>
						<input class="thisInput" name="date" type="text" id="dateByHour" value="{{ selection['date'] }}">
					</td>
					<td>
						<select name="hour">
							<option value="09">09:00</option><option value="10">10:00</option>
							<option value="11">11:00</option><option value="12" selected>12:00</option>
							<option value="13">13:00</option><option value="14">14:00</option>
							<option value="15">15:00</option><option value="16">16:00</option>
							<option value="17">17:00</option><option value="18">18:00</option>
							<option value="19">19:00</option><option value="20">20:00</option>
							<option value="21">21:00</option><option value="22">22:00</option>
						</select>
					<td>
				</tr>
			</table>
		</div>
		<div id="byDayDiv">
			<label>{% trans %}Entrada{% endtrans %}</label>
			<input class="thisInput" name="StartDate" type="text" id="dateByDaySD" value="{{ selection['StartDate'] }}">
			<label>{% trans %}Salida{% endtrans %}</label>
			<input class="thisInput" name="EndDate" type="text" id="dateByDayED" value="{{ selection['EndDate'] }}">
		</div>
		{% else %}
			&nbsp;&nbsp;<input id="byHour" type="radio" name="type" value="hour" checked>{% trans %}Hora{% endtrans %}&nbsp;&nbsp;<input id="byDay" type="radio" name="type" value="day">{% trans %}Día{% endtrans %}

			<div id="byHourDiv">
			<table class="dateHourTable">
					<th><label>{% trans %}Fecha{% endtrans %}</label></th>
					<th><label style="float: right;">{% trans %}Hora{% endtrans %}</label></th>
				</tr>
				<tr>
					<td>
						<input class="thisInput" name="date" type="text" id="dateByHour">
					</td>
					<td>
						<select name="hour">
							{% if selection['hour'] == 09 %}<option value="09" selected>09:00</option>{% else %}<option value="09">09:00</option>{% endif %}
							{% if selection['hour'] == 10 %}<option value="10" selected>10:00</option>{% else %}<option value="10">10:00</option>{% endif %}
							{% if selection['hour'] == 11 %}<option value="11" selected>11:00</option>{% else %}<option value="11">11:00</option>{% endif %}
							{% if selection['hour'] == 12 %}<option value="12" selected>12:00</option>{% else %}<option value="12">12:00</option>{% endif %}
							{% if selection['hour'] == 13 %}<option value="13" selected>13:00</option>{% else %}<option value="13">13:00</option>{% endif %}
							{% if selection['hour'] == 14 %}<option value="14" selected>14:00</option>{% else %}<option value="14">14:00</option>{% endif %}
							{% if selection['hour'] == 15 %}<option value="15" selected>15:00</option>{% else %}<option value="15">15:00</option>{% endif %}
							{% if selection['hour'] == 16 %}<option value="16" selected>16:00</option>{% else %}<option value="16">16:00</option>{% endif %}
							{% if selection['hour'] == 17 %}<option value="17" selected>17:00</option>{% else %}<option value="17">17:00</option>{% endif %}
							{% if selection['hour'] == 18 %}<option value="18" selected>18:00</option>{% else %}<option value="18">18:00</option>{% endif %}
							{% if selection['hour'] == 19 %}<option value="19" selected>19:00</option>{% else %}<option value="19">19:00</option>{% endif %}
							{% if selection['hour'] == 20 %}<option value="20" selected>20:00</option>{% else %}<option value="20">20:00</option>{% endif %}
							{% if selection['hour'] == 21 %}<option value="21" selected>21:00</option>{% else %}<option value="21">21:00</option>{% endif %}
							{% if selection['hour'] == 22 %}<option value="22" selected>22:00</option>{% else %}<option value="22">22:00</option>{% endif %}
						</select>
					<td>
				</tr>
			</table>
		</div>
		<div id="byDayDiv" style="display:none">
			<label>{% trans %}Entrada{% endtrans %}</label>
			<input class="thisInput" name="StartDate" type="text" id="dateByDaySD">
			<label>{% trans %}Salida{% endtrans %}</label>
			<input class="thisInput" name="EndDate" type="text" id="dateByDayED">
		</div>
		{% endif %}

		

		<div class="text-center">
			<button value="Send" class="btn btn-success" type="submit">
				<i class="glyphicon glyphicon-search"></i>&nbsp;{% trans %}Buscar{% endtrans %}
			</button>
		</div>
	</form>
</div>

{# Resultados #}

	{% block results %}{% endblock %}

{% endblock %}