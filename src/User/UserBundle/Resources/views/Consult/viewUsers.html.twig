{% extends '::admin.html.twig' %}

{% block page_title %}
    {% trans %}Ver usuarios{% endtrans %}
{% endblock %}

{% block page_content %}
	<div class="userFilter">
			{%trans%}Filtrar por email{%endtrans%} <select name="filterByUser" id="filterByUser">
				<option value="0">{% trans %}todos{% endtrans %}</option>
				{% for oneEmail in allEmails %}
					<option value="{{ oneEmail.ownerID }}">{{ oneEmail.email }}</option>
				{% endfor %}
			</select> 
			</br>
			{%trans%}Filtrar por tipo de usuario{%endtrans%} <select name="filterByRole" id="filterByRole">
				<option value="all">{% trans %}todos{% endtrans %}</option>
				<option value="Admin">{% trans %}administradores{% endtrans %}</option>
				<option value="Owner">{% trans %}propietarios{% endtrans %}</option>
				<option value="User">{% trans %}usuarios{% endtrans %}</option>
			</select> 
	</div>

	{% for oneUser in allUsers %}

		{% set role = 'Desconcido' %}

		{% if oneUser.role == "ROLE_SUPER_ADMIN" %}
			{% set role = 'Administrador' %}
			{% set class = 'box-danger' %}
		{% elseif oneUser.role == "ROLE_ADMIN" %}
			{% set role = 'Propietario' %}
			{% set class = 'box-warning' %}
		{% elseif oneUser.role == "ROLE_USER" %}
			{% set role = 'Usuario' %}
			{% set class = 'box-success' %}
		{% endif %}

        <div class="box {{ class }} userDiv {{ oneUser.userID }}">
            <div class="box-header with-border">
                <h3 class="box-title"><a href="view-users/{{ oneUser.userID }}">{{ oneUser.name }} {{ oneUser.surname }}</a> ( {{ oneUser.email }} )</h3>
                <div class="box-tools pull-right">
                    {% if oneUser.active %}
                        <span class="label label-success">{% trans %}Activo{% endtrans %}</span>
                    {% else %}
                        <span class="label label-danger">{% trans %}Inactivo{% endtrans %}</span>
                    {% endif %}
                    <button data-widget="collapse" class="btn btn-box-tool"><i class="fa fa-minus"></i></button>
                    <button data-widget="remove" class="btn btn-box-tool"><i class="fa fa-times"></i></button>
                </div><!-- /.box-tools -->
            </div><!-- /.box-header -->
            <div class="box-body">
                <div class="row">
                    <div class="col-md-6">
                        <ul class="list-unstyled">
                            <li><i class="fa fa-phone"></i> {{ oneUser.phone }}</li>
                            <li><i class="fa fa-mobile"></i> {{ oneUser.mobile }}</li>
                        </ul>
                    </div><!-- /.col -->
                    <div class="col-md-6">
                        {% if oneUser.properties is defined %}
                            <ul class="list-unstyled">
                                {% for property in oneUser.properties %}
                                    <li><a href="{{ path('adminDetails', {'property':property.id}) }}">{{ property.name }}</a> ( {{ property.numBookings }} )</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </div><!-- /.col -->
                </div>

            </div><!-- /.box-body -->
            <div class="box-footer">
                <p>{{ role }}</p>
            </div><!-- box-footer -->
        </div>
	{% endfor %}

	<script>
		var filterByUser = document.getElementById("filterByUser");

		filterByUser.onchange = function(){
			var userID = filterByUser.options[filterByUser.selectedIndex].value;

			if(userID == 0){
				$('.userDiv').show('slow');
			}
			else{
				$('.userDiv').hide('slow');
 				$('.'+ userID).show('slow');
 			}
  		}

		var filterByRole = document.getElementById("filterByRole");

		filterByRole.onchange = function(){
			var selectedRole = filterByRole.options[filterByRole.selectedIndex].value;

			switch(selectedRole) {
				case 'Admin':
					$('.userDiv').hide('slow');
 					$('.box-danger').show('slow');
					break;

				case 'Owner':
					$('.userDiv').hide('slow');
 					$('.box-warning').show('slow');
					break;

				case 'User':
					$('.userDiv').hide('slow');
 					$('.box-success').show('slow');
					break;

				default:
					$('.userDiv').show('slow');
			}
  		}
	</script>

{% endblock %}